# 传统博弈


## 巴什博奕

### 问题模板

> 有 $N$ 个石子，两名玩家轮流行动，按以下规则取石子：。
>
> 规定：每人每次可以取走 $X(1 \le X \le M)$ 个石子，拿到最后一颗石子的一方获胜。
>
> 双方均采用最优策略，询问谁会获胜。

### 最核心思路：分类讨论

巴什博弈是一种减法博弈，减法博弈的共同特征为玩家轮流从某一总数（对应本题 $N$ 件物品）中减去某个数值（对应本题拿取物品），所减去的数值限定在某个集合中（对应本题 $1 \le X \le M$ ），先将数值减为 $0$ 者（对应本题拿到最后一颗石子的一方）获胜。

### 结论与证明

- $N=K*(M+1)$ （其中 $K \in \mathbb{N}^+$ ），后手必胜（后手可以控制每一回合结束时双方恰好取走 $M+1$ 个，重复 $K$ 轮后即胜利）；
- $N=K*(M+1)+R$ （其中 $K \in \mathbb{N}^+,0 < R < M + 1$ ），先手必胜（先手先取走 $R$ 个，之后控制每一回合结束时双方恰好取走 $M+1$ 个，重复 $K$ 轮后即胜利）。

### 变体

1. 报数巴什博弈

   这一变体本质上与传统的巴什博弈完全等价，题目背景为：

   > 两名玩家轮流报数。
   >
   > 规定：第一个报数的人可以报 $X(1 \le X \le M)$ ，后报数的人需要比前者所报数大 $Y(1 \le Y \le M)$ ，率先报到 $N$ 的人获胜。
   >
   > 双方均采用最优策略，询问谁会获胜。

   直接用传统巴什博弈的解法做题即可。

2. 反转获胜条件的巴什博弈

   这一变体本质上就是传统的巴什博弈反一下结论。~~不会吧真的有出题人出这种水题吗~~ 题目背景为：

   > 有 $N$ 个石子，两名玩家轮流行动取石子。
   >
   > 规定：每人每次可以取走 $X(1 \le X \le M)$ 个石子，将石子取完的一方输掉比赛。
   >
   > 双方均采用最优策略，询问谁会获胜。

   将传统巴什博弈的结论反一下即可：$N=K*(M+1)$ ，先手必胜。

## 扩展巴什博弈

### 问题模板

> 有 $N$ 颗石子，两名玩家轮流行动，按以下规则取石子：。
>
> 规定：每人每次可以取走 $X(a \le X \le b)$ 个石子，如果最后剩余物品的数量小于 $a$ 个，则不能再取，拿到最后一颗石子的一方获胜。
>
> 双方均采用最优策略，询问谁会获胜。

### 最核心思路：分类讨论

### 结论

参考传统巴什博弈的结论，我们可以得到：

- $N = K*(a+b)$ 时，后手必胜；
- $N = K*(a+b)+R_1$ （其中 $K \in \mathbb{N}^+,0 < R_1 < a$ ） 时，后手必胜（这些数量不够再取一次，先手无法逆转局面）；
- $N = K*(a+b)+R_2$ （其中 $K \in \mathbb{N}^+,a \le R_2 \le b$ ） 时，先手必胜；
- $N = K*(a+b)+R_3$ （其中 $K \in \mathbb{N}^+,b < R_3 < a + b$ ） 时，先手必胜（这些数量不够再取一次，后手无法逆转局面）；

### 变体

1. 需要取完全部的石头

   > 有 $N$ 颗石子，两名玩家轮流行动，按以下规则取石子：。
   >
   > 规定：每人每次可以取走 $X(a \le X \le b)$ 个石子，如果最后剩余物品的数量小于 $a$ 个，**则可以一次性取完**，拿到最后一颗石子的一方获胜。
   >
   > 双方均采用最优策略，询问谁会获胜。

   对传统扩展巴什博弈的结论做一下修改即可得到结论：

   - $N = K*(a+b)$ 时，后手必胜；
   - $N = K*(a+b)+R_1$ （其中 $K \in \mathbb{N}^+,0 < R_1 < a$ ） 时，先手必胜（这些数量刚好够再取一次）；
   - $N = K*(a+b)+R_2$ （其中 $K \in \mathbb{N}^+,a \le R_2 \le b$ ） 时，先手必胜；
   - $N = K*(a+b)+R_3$ （其中 $K \in \mathbb{N}^+,b < R_3 < a + b$ ） 时，后手必胜（这些数量刚好够再取一次）；


## 解题工具：$\tt{}PN$ 图

### 最核心思路：必胜态（ $\tt{}N$ ）和必败态 （ $\tt{}P$ ）的相互转化

- 任何**可以**转化为必败态的状态都是必胜态；
- 任何**只能**转化为必胜态的状态都是必败态。


## $\tt{}NIM$ 游戏

### 问题模板

> 有 $N$ 堆石子，给出每一堆的石子数量，两名玩家轮流行动，按以下规则取石子：
>
> 规定：每人每次任选一堆，取走正整数颗石子，拿到最后一颗石子的一方获胜（注：几个特点是**不能跨堆**、**不能不拿**）。
>
> 双方均采用最优策略，询问谁会获胜。

### 最核心思路：逆向推导 + 镜像局面

一般的解法是从结局状态出发，通过必胜态（ $\tt{}N、W$ ）和必败态 （ $\tt{}P、L$ ）的相互转化得到猜想，然后再证明猜想成立。

### 结论

记初始时各堆石子的数量 $(A_1,A_2, … ,A_n)$ ，定义尼姆和 $Sum_N = A_1 \bigoplus A_2 \bigoplus … \bigoplus A_n$ 。

**当 $\pmb{ Sum_N = 0 }$ 时先手必败，反之先手必胜。**

由最终态（每堆石子数量均为 $0$ ，此时 $Sum_N = 0$ ，必败）逆向推导得到。

### 变体

1. 具体取法

   这一变体实际上考查的是尼姆博弈的证明，题目背景为：

   > 给出一局先手必胜的尼姆博弈，问：先手应该如何取石子才能保证仍是先手必胜。

   结论如下：

   > 先计算出尼姆和，再对每一堆石子计算 $A_i \bigoplus Sum_N$ ，记为 $X_i$ 。
   >
   > 若得到的值 $X_i<A_i$ ，$X_i$ 即为一个可行解，即**剩下 $\pmb X_i$ 颗石头，取走 $\pmb {A_i - X_i}$ 颗石头**（这里取小于号是因为至少要取走 $1$ 颗石子）。

   这一题的推导过程与尼姆博弈的一样，都是需要根据最终态（先手第一回合取完后要构造必败态，即 $Sum_N = 0$ ）逆向推导，如下：

   <details>
   <summary>证明（非严格）</summary>


   > 剩下 $X_i$ 颗石头，那么新的尼姆和即为
   >
   > $$Sum_N' = A_1 \bigoplus A_2 \bigoplus … \bigoplus A_{i - 1} \bigoplus \pmb{X_i} \bigoplus A_{i + 1} \bigoplus … \bigoplus A_n $$
   >
   > 等价于
   >
   > $$Sum_N' = A_1 \bigoplus A_2 \bigoplus … \bigoplus A_{i - 1} \bigoplus \pmb{A_i \bigoplus  Sum_N} \bigoplus A_{i + 1} \bigoplus … \bigoplus A_n$$
   >
   > 将 $Sum_N$ 代回，得到 $Sum_N'=0$ 。
   > </details>

2. 带限定的 $\tt{} NIM$ 游戏

   题目背景为：

   > 给定一个集合 $T=\{t_1,t_2,… | t_i \in  \mathbb{N}^+\}$，有 $N$ 堆石子，给出每一堆的石子数量，，两名玩家轮流行动，按以下规则取石子：
   >
   > 规定：每人每次任选一堆，取走 $X \in T$ 颗石子，拿到最后一颗石子的一方获胜。
   >
   > 双方均采用最优策略，询问谁会获胜。

   解题方法请参见本文《SG函数》。


## $\tt{} Moore’s\ Nim$ 游戏（$\tt{}Nim - K$ 游戏）

### 问题模板

> 有 $N$ 堆石子，给出每一堆的石子数量，两名玩家轮流行动，按以下规则取石子：
>
> 规定：每人每次任选不超过 $K$ 堆，对每堆都取走不同的正整数颗石子，拿到最后一颗石子的一方获胜。
>
> 双方均采用最优策略，询问谁会获胜。

### 结论

把每一堆石子的石子数用二进制表示，定义 $One_i$ 为二进制第 $i$ 位上 $1$ 的个数。

**以下局面先手必胜：**

**对于每一位， $\pmb{One_1,One_2,… ,One_N}$ 均不为 $\pmb{K+1}$ 的倍数。**

### 证明

<details>
<summary>点击查看证明 - 数学归纳法</summary>


1. 必败态：石子全部为 $0$ ，没有石子可取。

2. <u>任何一个必败态，经过一次操作后必定转变为必胜态。</u>显然的，一次操作至多只能改变 $K$ 堆石子的数量，即使得某一位 $One_i$ 变为 $One_i' \in [One_i - K, One_i + K]$ ，此时， $One_i'$ 必然不可能是 $k+1$ 的整数倍，故必定转变为必胜态。

3. <u>任何一个必胜态，总有一种方式使得经过一次操作后转变为必败态。</u>这里使用数学归纳法的思想会比较好理解（我查询了几乎大半个中文互联网的资料，可能是我理解力太弱了，看了很久别人的博客都没明白这里是怎么证明的，终于，在我自己理解之后，我发现用数规解释比较直观，所以在这里我就用不严格的数规证明一下）。

   我们从高到低考虑每一个二进制位，**假设**当 $N=i$ 时命题成立，即我们挑选了 $j(j \le K)$ 堆石子取石子，使得第 $1$ 位到第 $i$ 位上 $'1'$ 的数量全部为 $K+1$ 的倍数。

   现在证明对于 $N=i+1$ 时命题也成立。由于已经挑选了 $j$ 堆石子，所以这 $j$ 堆石子的第 $i+1$ 位是不固定的，假设此时还有 $t$ 堆石子的这一位是 $'1'$ ，分类讨论：

   - $t+j \le K$ ，那么只需要将这一位全部的 $'1'$ 置为 $'0'$ 即可；
   - $t+j > K$ ，那么我们只需要将 $j$ 堆已选石子中的 $K+1-t$ 堆的这一位置为 $'0'$ 。

   综上，可证命题恒成立。

</details>

<details>
<summary>点击查看证明 - 基于传统 $\tt{} Nim$ 游戏</summary>


考虑传统 $\tt{}Nim$ 游戏的结论：对石头的数量取异或。异或本质上是二进制异或，而本题即考虑为 $K+1$ 进制异或。


## $\tt{}Anti-Nim$ 游戏（反 $\tt{}Nim$ 游戏）

### 问题模板

> 有 $N$ 堆石子，给出每一堆的石子数量，两名玩家轮流行动，按以下规则取石子：
>
> 规定：每人每次任选一堆，取走正整数颗石子，拿到最后一颗石子的一方**出局**。
>
> 双方均采用最优策略，询问谁会获胜。

### 最核心思路：分类讨论

### 结论

**以下局面先手必胜：**

- **所有堆的石头数量均不超过 $1$ ，且 $\pmb {Sum_N=0}$ （也可看作“且有偶数堆”）；**
- **至少有一堆的石头数量大于 $1$ ，且 $\pmb{Sum_N \neq 0}$ 。**

### 证明

<details>
<summary>点击查看证明</summary>


- （1）所有堆的石子数量均为 $1$ ，与奇偶有关：
  - （1.1）共奇数堆石子，先手必败；
  - （1.2）共偶数堆石子，先手必胜；

- （2）仅有一堆的石子数量大于 $1$ ：
  - （2.1）共奇数堆石子，先手将大于 $1$ 的那堆石子取到 $1$ 颗，此时转化为（1.1），先手必胜；
  - （2.2）共偶数堆石子，先手将大于 $1$ 的那堆石子取完，此时转化为（1.1），先手必胜；

- （3）有两堆及以上的石子数量大于 $1$ 。

我们利用传统 $\tt{}Nim$ 博弈的结论对于上述分类讨论的第（3）点进行更进一步的分类讨论。

> 若当下 $Sum_N=0$ ，无论怎么操作必定会有 $Sum_N'\neq 0$ ；
>
> 若当下 $Sum_N\neq 0$ ，存在一种取法使得 $Sum_N'=0$ 。

（3.1）当 $Sum_N=0$ 时进行操作，只可能得到两种结果：

- 依然有两堆及以上的石子数量大于 $1$ ，此时 $Num_N\neq 0$ ；

- 仅有一堆的石子数量大于 $1$ ，此时转化为（2），先手必胜。

（3.2）当 $Sum_N\neq 0$ 时进行操作，存在以下的结果：

- 依然有两堆及以上的石子数量大于 $1$ ，且 $Num_N = 0$ ，转化为（3.1）；

- 依然有两堆及以上的石子数量大于 $1$ ，且 $Num_N \neq 0$ ，转化为（3.2）；

- 仅有一堆的石子数量大于 $1$ ，此时转化为（2），先手必胜。

<u>任何一个必败态，经过一次操作后必定转变为必胜态</u>。我们发现，对于必败态（3.1）这一条件成立。

<u>任何一个必胜态，总有一种方式使得经过一次操作后转变为必败态</u>。我们发现，对于必胜态（3.2），一定存在一种方式转变为（3.1），这一条件也成立。

综上，可证命题恒成立


## 阶梯 - $\tt{}NIM$ 博弈

### 问题模板

> 有 $N$ 级台阶，每一级台阶上均有一定数量的石子，给出每一级石子的数量，两名玩家轮流行动，按以下规则操作石子：
>
> 规定：每人每次任选一级台阶，拿走正整数颗石子放到下一级台阶中，已经拿到地面上的石子不能再拿，拿到最后一颗石子的一方获胜。
>
> 双方均采用最优策略，询问谁会获胜。
>

### 最核心思路：镜像局面

### 结论

**以下局面先手必胜：**

**对奇数台阶做传统 $\pmb{\tt{}Nim}$ 博弈，当 $\pmb{Sum_N=0}$ 时先手必败，反之先手必胜。**

### 证明

<details>
<summary>点击查看证明</summary>


首先分析这一问题与传统的 $\tt{}NIM$ 博弈的区别，在于传统 $\tt{}NIM$ 是直接将石子拿走，故不会对其他堆的石子数量造成影响，而这一问题会改变其他堆的石子数量。

然而，真的是这样吗？其实不然，我们有方法把这个影响归零。

假设对手移动了**偶数台阶**上的 $K$ 个石子，那么你只需要将这 $K$ 个石子再移动一次，那么这 $K$ 个石子又会回到偶数台阶上，这样，奇数台阶上的石子数量不会发生改变（相当于无效回合）。以此往复，可以保证你将所有偶数台阶上的石子**亲手**移动到**地面**上，所以，移动偶数台阶上的石子是没有意义的，答案只与奇数台阶上的石子数量挂钩。

再次分析这一问题与传统 $\tt{}NIM$ 博弈的区别，我们发现，由于偶数台阶可以被忽视，移动奇数台阶上的石子（到偶数台阶上）就相当于**直接拿走**。至此，本题转化为奇数台阶的 $\tt{}NIM$ 博弈。

</details>

### 变体

> POJ1704 - Georgia and Bob
>
> 题意：
>
> 长条的盒子划分为 $N$ 个格子，一些格子里有石子。两名玩家轮流行动，每次可以任选一个石子，将其向左移动，但不允许反超其他棋子，且一个格子只能放置一个石子。没有石子可以移动时就算输。
>
> 思路 - 1：
>
> 石子间的空格就相当于是引例中台阶上的石子数量，两题等价。
>
> 思路 - 2：
>
> 将石子从后往前，两两捆绑为一组。一旦对手移动某一组的前一个石子，那么你只需要将后一个石子移动相同的格子，这一组石子之间的距离便不会被改变（相当于无效回合）。所以，组所在的位置是没有意义的，答案只与组内石子的距离挂钩。
>
> 一旦对手移动某一组的后一个石子，那么就相当于在做传统的 $\tt{}NIM$ 博弈。故我们只需要考虑每一组两个石子之间的距离即可。

> HDU4315 - Climbing the Hill
>
> 题意：
>
> 一座山划分为 $N$ 个高度，一些高度上有人。两名玩家轮流行动，每次可以任选一个人，将其向上移动，但不允许反超其他人，且除了山顶外，同一高度只有一个人。将其中一个人定义为国王，将国王移动到山顶就算赢。
>
> 思路：
>
> 我们先不考虑国王这一条件，可以发现，虽然山顶可以有多个人，但这只影响了组所在的位置，这一条件是为了“国王”而存在的，所以这一问题与上一题并没有区别。
>
> 现在考虑国王这一条件，有情况需要特判：
>
> - 当国王在第一个时，先手必胜；
> - 当国王在第二个，且总人数为奇数时，显然，第一个人不能被率先移到山顶，所以要进行特判。
> - 其余情况等同于无国王情况。


## 解题工具：$\tt SG$ 游戏（有向图游戏）

任何博弈问题都可以转化为有向图游戏。简单来说，即是将一局博弈的每一种局面全部罗列下来，然后暴力求解，得到规律；形象来说，我们把一个局面抽象成一个点，在起点有一颗棋子，两个人选取最优策略轮流对这颗棋子进行移动，最后不能移动棋子的人失败，这样可以得到一张有向图。我们使用以下几条规则来定义暴力求解的过程：

- 使用数字来表示输赢情况，$0$ 代表局面必败，非 $0$ 代表**存在必胜可能**，我们称这个数字为这个局面的SG值；
- 找到最终态，根据题意人为定义最终态的输赢情况；
- 对于非最终态的某个节点，其SG值为所有子节点的SG值取 $\tt{}mex$ ；
- 单个游戏的输赢态即对应根节点的SG值是否为 $0$ ，为 $0$ 代表先手必败，非 $0$ 代表先手必胜；
- 多个游戏的总SG值为单个游戏SG值的异或和。

其中，在学习时我提出的一个问题是，为什么要使用 $\tt{}mex$ 函数代替 $0,1$ ，在重构本文时我有了进一步的理解，即这是求解为了多个游戏的总SG值服务，如果只是单个游戏的话，直接使用 $0,1$ 也可以。

下面使用两个具体例题对这一知识点的使用做讲解。

### 例题

1. 经典 $\tt {}NIM$ 游戏

   我们使用SG函数与有向图游戏验证结论的正确性，题目背景为：

   > 有三堆石子，数量分别为 $3,2,5$ ，两名玩家轮流行动，按以下规则取石子：
   >
   > 规定：每人每次任选一堆，取走正整数颗石子，拿到最后一颗石子的一方获胜。
   >
   > 双方均采用最优策略，询问谁会获胜。

   建立有向图如下：

   ![](https://img2022.cnblogs.com/blog/2491503/202208/2491503-20220810131020017-169030818.png)

   随后，对于所有的最终态，我们人为的标定其SG值：

   ![](https://img2022.cnblogs.com/blog/2491503/202208/2491503-20220810141326529-760790244.jpg)

   最后，填充所有节点的SG值：

   ![](https://img2022.cnblogs.com/blog/2491503/202208/2491503-20220810141421140-167561634.jpg)

   我们发现，这道题的总SG值即为 $3 \bigoplus 6 \bigoplus 2$ ，即上方尼姆博弈的结论。

2. 带限定的 $\tt{} NIM$ 游戏

   题目背景为：

   > 有两堆石子，数量分别为 $10,5$ ，两名玩家轮流行动，按以下规则取石子：
   >
   > 规定：每人每次任选一堆，取走 $2$ 颗或 $5$ 颗石头，拿到最后一颗石子的一方获胜。
   >
   > 双方均采用最优策略，询问谁会获胜。

   建立有向图如下：

    <img src="https://img2022.cnblogs.com/blog/2491503/202208/2491503-20220809224145929-656614460.jpg" alt="3773cfe000ea3f1536ed049a29d3a26.jpg" style="zoom:50%;" />

   我们发现，总SG值即为 $1 \bigoplus 2=3$ ，本题先手必胜。


## $\tt Anti-SG$ 游戏（反 $\tt SG$ 游戏）

$\tt SG$ 游戏中最先不能行动的一方获胜。

### 结论

**以下局面先手必胜：**

- **单局游戏的SG值均不超过 $\pmb 1$ ，且总SG值为 $\pmb 0$；**

- **至少有一局单局游戏的SG值大于 $\pmb 1$ ，且总SG值不为 $\pmb 0$ 。**

在本质上，这与 $\tt Anti-Nim$ 游戏的结论一致。


## $\tt{}Lasker’s-Nim$ 游戏（$\tt Multi-SG$ 游戏）

### 问题模板

> 有 $N$ 堆石子，给出每一堆的石子数量，两名玩家轮流行动，每人每次任选以下规定的一种操作石子：
>
> - 任选一堆，取走正整数颗石子；
> - 任选数量大于 $2$ 的一堆，分成两堆非空石子。
>
> 拿到最后一颗石子的一方获胜。双方均采用最优策略，询问谁会获胜。

### 最核心思路：SG函数

### 结论

**本题使用SG函数求解，SG值定义为：**

$$\pmb{ SG(x) = 
\begin{cases}
x-1 & \text{ , } x\mod 4= 0\\ 
x & \text{ , } x \mod 4 = 1\\ 
x & \text{ , } x \mod 4 = 2\\ 
x+1 & \text{ , } x \mod 4 = 3
\end{cases}}$$

### 证明

<details>
<summary>点击查看证明</summary>


根据SG函数（一局游戏的SG值等于其所有子游戏SG值的异或和）的定义我们不难得到本题结论

## $\tt{}Every-SG$ 游戏

### 问题模板

> 给出一个有向无环图，其中 $K$ 个顶点上放置了石子，两名玩家轮流行动，按以下规则操作石子：
>
> 移动图上所有还能够移动的石子；
>
> 无法移动石子的一方出局。双方均采用最优策略，询问谁会获胜。

### 最核心思路：SG函数

### 结论

定义 $step$ 为某一局游戏至多需要经过的回合数。

**以下局面先手必胜：**

**$\pmb{step}$为奇数** 。


## 斐波那契博弈

### 问题模板

> 有一堆石子，数量为 $N$ ，两名玩家轮流行动，按以下规则取石子：
>
> 先手第1次可以取任意多颗，但不能全部取完，此后每人取的石子数不能超过上个人的两倍，拿到最后一颗石子的一方获胜。
>
> 双方均采用最优策略，询问谁会获胜。

### 结论

当且仅当 $N$ 为斐波那契数时先手必败。


## 威佐夫博弈

### 问题模板

> 有两堆石子，给出每一堆的石子数量，两名玩家轮流行动，每人每次任选以下规定的一种操作石子：
>
> - 任选一堆，取走正整数颗石子；
> - 从两队中同时取走正整数颗石子。
>
> 拿到最后一颗石子的一方获胜。双方均采用最优策略，询问谁会获胜。

### 结论

**以下局面先手必败：**

**$\pmb{ (1, 2), (3, 5), (4, 7), (6, 10), …}$ 具体而言，每一对的第一个数为此前没出现过的最小整数，第二个数为第一个数加上 $\pmb{1,2,3,4,…}$ 。**

**更一般地，对于第 $\pmb k$ 对数，第一个数为 $\pmb {First_k= \left \lfloor \frac{k*(1+\sqrt 5)}{2} \right \rfloor}$ ，第二个数为 $\pmb{Second_k=First_k+k}$ 。**

其中，在两堆石子的数量均大于 $10^9$ 次时，由于需要使用高精度计算，我们需要人为定义 $\frac{1+\sqrt 5}{2}$ 的取值为 $lorry = 1.618033988749894848204586834$ 。


## 树上删边游戏

### 问题模板

> 给出一棵 $N$ 个节点的有根树，两名玩家轮流行动，按以下规则操作：
>
> 选择任意一棵子树并删除（删去任意一条边，不与根相连的部分会同步被删去）；
>
> 删掉最后一棵子树的一方获胜。双方均采用最优策略，询问谁会获胜。

### 最核心思路：SG函数

### 结论

**相较于传统SG值的定义，本题的SG函数值定义为：**

- **叶子节点的SG值为 $\pmb 0$ 。**
- **非叶子节点的SG值为其所有孩子节点SG值 $\pmb + 1$ 的异或和。**

## 无向图删边游戏

### 问题模板

> 给出一张 $N$ 个节点的无向联通图，有一个点作为图的根，两名玩家轮流行动，按以下规则操作：
>
> 选择任意一条边删除，不与根相连的部分会同步被删去；
>
> 删掉最后一条边的一方获胜。双方均采用最优策略，询问谁会获胜。

### 最核心思路：转化为“树上删边游戏”+SG函数

### 结论

这个模型有一个著名的结论——Fusion Principle定理。描述如下：

**我们根据下方的结论对无向图进行等价转换：**

- **对于奇环，我们将其缩成一个新点+一条新边；**
- **对于偶环，我们将其缩成一个新点；**
- **所有连接到原来环上的边全部与新点相连。**

**此时，本模型转化为“树上删边游戏”。**

这个原理的证明非常复杂，只需记结论即可。